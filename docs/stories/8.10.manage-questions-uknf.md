# Story 8.10: Manage Questions (UKNF)

**Epic:** 8 - Entity Management & Q&A  
**Story Number:** 8.10  
**Created:** 2025-10-04

---

## Status

**Pending** ⏳

---

## Story

**As a** UKNF Employee,  
**I want to** view, manage, and respond to submitted questions,  
**So that** I can build a helpful FAQ knowledge base.

---

## Acceptance Criteria

1. UKNF Employee can view list of all questions with: Title, Category, Status, Submission date, Rating (if published)
2. Employee can filter by: Status (Pending, Answered, Published, Rejected), Category, Date range
3. Employee can search by: Title, Content, Tags
4. Employee can click question to view full details
5. Question details show: Full title, Full content, Category, Tags, Submission date, Status
6. Employee can perform actions:
   - **Add Answer**: Provide answer text (rich text editor)
   - **Publish**: Make Q&A pair visible to all users
   - **Edit**: Modify question title/content/category/tags (for clarity or grammar)
   - **Reject**: Mark question as not suitable for FAQ (with reason)
   - **Delete**: Remove question entirely
7. Status transitions:
   - Pending → Answered (when answer added) → Published (when published)
   - Pending → Rejected (if not suitable for FAQ)
8. All actions are logged with timestamp and employee ID

---

## Tasks / Subtasks

### Backend Tasks

- [ ] **Task 1: Create GetQuestionsQuery** (AC: 1, 2, 3)
  - [ ] Create `GetQuestionsQuery.cs` in `Application/UknfPlatform.Application.Communication/QA/Queries/`
  - [ ] Query parameters:
    - StatusFilter (enum?, optional)
    - CategoryFilter (string?, optional)
    - StartDate, EndDate (DateTime?, optional)
    - SearchTerm (string?, optional)
    - PageNumber, PageSize
  - [ ] Create `GetQuestionsQueryHandler.cs`
  - [ ] Implement filtering, search, pagination
  - [ ] Return PagedResult<QuestionListItemDto>

- [ ] **Task 2: Create GetQuestionByIdQuery** (AC: 4, 5)
  - [ ] Create `GetQuestionByIdQuery.cs`
  - [ ] Query parameters: QuestionId
  - [ ] Return QuestionDetailDto with all fields including submitter info (for UKNF only)

- [ ] **Task 3: Create UpdateQuestionCommand** (AC: 6)
  - [ ] Create `UpdateQuestionCommand.cs`
  - [ ] Allow editing: Title, Content, Category, Tags
  - [ ] Create handler with audit logging

- [ ] **Task 4: Create RejectQuestionCommand** (AC: 6, 7)
  - [ ] Create `RejectQuestionCommand.cs`
  - [ ] Command properties: QuestionId, RejectionReason
  - [ ] Handler updates status to Rejected
  - [ ] Log rejection with reason

- [ ] **Task 5: Create DeleteQuestionCommand** (AC: 6)
  - [ ] Create `DeleteQuestionCommand.cs`
  - [ ] Soft delete (mark as deleted, don't remove from database)
  - [ ] Log deletion

- [ ] **Task 6: Create REST API endpoints** (AC: 1, 4, 6)
  - [ ] GET /api/admin/qa/questions (list with filters)
  - [ ] GET /api/admin/qa/questions/{id} (details)
  - [ ] PUT /api/admin/qa/questions/{id} (edit)
  - [ ] POST /api/admin/qa/questions/{id}/reject (reject)
  - [ ] DELETE /api/admin/qa/questions/{id} (delete)
  - [ ] Add `[Authorize]` with UKNF role check
  - [ ] Add Swagger documentation

- [ ] **Task 7: Create audit logging** (AC: 8)
  - [ ] Log all actions: View, Edit, Answer, Publish, Reject, Delete
  - [ ] Include timestamp, employee ID, action type, question ID

### Frontend Tasks

- [ ] **Task 8: Create question-management component** (AC: 1, 2, 3, 4)
  - [ ] Create `src/Frontend/uknf-platform-ui/src/app/features/admin/qa-management/question-management.component.ts`
  - [ ] Configure routing: `/admin/qa/questions` (UKNF only)
  - [ ] Display questions in table
  - [ ] Columns: Title, Category, Status, Submitted, Rating (if published)
  - [ ] Click row to view details

- [ ] **Task 9: Implement filters and search** (AC: 2, 3)
  - [ ] Status filter dropdown (All, Pending, Answered, Published, Rejected)
  - [ ] Category filter dropdown
  - [ ] Date range picker
  - [ ] Search input (debounced, searches title/content/tags)
  - [ ] Update table on filter/search changes

- [ ] **Task 10: Create question-detail component** (AC: 4, 5, 6)
  - [ ] Create `question-detail.component.ts`
  - [ ] Configure routing: `/admin/qa/questions/:id`
  - [ ] Display full question details
  - [ ] Show submitter info (internal, for UKNF only)
  - [ ] Action buttons: Add Answer, Publish, Edit, Reject, Delete
  - [ ] Status badge

- [ ] **Task 11: Implement action handlers** (AC: 6, 7)
  - [ ] Edit button: Open inline edit or modal
  - [ ] Reject button: Show reason dialog, call reject API
  - [ ] Delete button: Show confirmation dialog, call delete API
  - [ ] Add Answer button: Navigate to Story 8.11 flow
  - [ ] Publish button: Navigate to Story 8.12 flow

- [ ] **Task 12: Create edit question modal** (AC: 6)
  - [ ] Modal with form fields: Title, Content, Category, Tags
  - [ ] Pre-populate with current values
  - [ ] Save changes via API
  - [ ] Show success/error message

### Testing Tasks

- [ ] **Task 13: Write unit tests**
  - [ ] Test: GetQuestionsQuery returns filtered questions
  - [ ] Test: Search works correctly
  - [ ] Test: UpdateQuestionCommand edits question
  - [ ] Test: RejectQuestionCommand changes status
  - [ ] Test: DeleteQuestionCommand soft deletes

- [ ] **Task 14: Write integration tests**
  - [ ] Test: GET /api/admin/qa/questions returns questions
  - [ ] Test: Filters and search work
  - [ ] Test: Edit/Reject/Delete endpoints work
  - [ ] Test: Authorization checks

---

## Dev Notes

### Status Workflow

```
Pending → Answered → Published
   ↓
Rejected
   ↓
Deleted
```

### Employee Permissions

- All UKNF Employees can view questions
- Only employees with "qa.manage" permission can edit/reject/delete
- All actions are audited

### UI Organization

Question list should show:
- Priority: Pending questions first (need attention)
- Status badges with color coding
- Quick actions menu on each row
- Pagination for large question counts

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-04 | 1.0 | Story created from Epic 8 | Scrum Master (AI) |

---

## Dev Agent Record

_This section will be populated by the development agent during implementation._

---

## QA Results

_This section will be populated by QA agent after story completion._

